<div class="booking-wrapper">
  <div class="form-container">
    <h1 class="form-title">Event Booking</h1>
    
    <div class="progress-container">
      <div class="step-indicators">
        <div *ngFor="let step of steps; let i = index" 
             [ngClass]="{'step-indicator': true, 'active': i === currentStep, 'completed': i < currentStep}">
          <div class="step-number">{{ i + 1 }}</div>
          <div class="step-name">{{ step.title }}</div>
        </div>
      </div>
      <div class="progress-bar">
        <div class="progress" [style.width.%]="(currentStep / (steps.length - 1)) * 100"></div>
      </div>
    </div>

    <div class="step-content">
      <h2>{{ steps[currentStep].title }}</h2>
      <p *ngIf="steps[currentStep].sub" class="step-subtitle">{{ steps[currentStep].sub }}</p>

      <form (ngSubmit)="onSubmit()">
        <ng-container [ngSwitch]="currentStep">

          <!-- Step 1: Customer Details -->
          <div *ngSwitchCase="0" class="form-step">
            <div class="form-group">
              <label for="fullName">Full Name</label>
              <input type="text" id="fullName" placeholder="Enter your full name" [(ngModel)]="form.fullName" name="fullName" required />
            </div>
            
            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input type="tel" id="phone" placeholder="Enter your phone number" [(ngModel)]="form.phone" name="phone" required />
            </div>
            
            <div class="form-group">
              <label for="email">Email Address</label>
              <input type="email" id="email" placeholder="Enter your email address" [(ngModel)]="form.email" name="email" required />
            </div>
          </div>

          <!-- Step 2: Event Details -->
          <div *ngSwitchCase="1" class="form-step">
            <div class="form-group">
              <label for="eventType">Event Type</label>
              <select id="eventType" [(ngModel)]="form.eventType" name="eventType" required (change)="checkYearField()">
                <option value="" disabled selected>Select Event Type</option>
                <option>Birthday Party</option>
                <option>Anniversary</option>
                <option>Bride to Be</option>
                <option>Holy Communion</option>
                <option>Corporate Event</option>
                <option>Other</option>
              </select>
            </div>

            <!-- Show "Which year?" if applicable -->
            <div *ngIf="showYearField" class="form-group">
              <label for="celebrationYear">Which year are you celebrating?</label>
              <input type="number" id="celebrationYear" placeholder="Enter celebration year" [(ngModel)]="form.celebrationYear"
                name="celebrationYear" />
            </div>

            <div *ngIf="form.eventType === 'Other'" class="form-group">
              <label for="otherEventType">Please specify the event type</label>
              <input type="text" id="otherEventType" placeholder="Describe your event" [(ngModel)]="form.otherEventType"
                name="otherEventType" (change)="onOtherEventTypeChange()" />
            </div>

            <div class="form-group">
              <label for="eventDateTime">Event Date & Time</label>
              <input type="datetime-local" id="eventDateTime" [(ngModel)]="form.eventDateTime" name="eventDateTime" required />
            </div>
              
            <div class="form-group">
              <label for="venue">Event Venue</label>
              <input type="text" id="venue" placeholder="Where will your event be held?" [(ngModel)]="form.venue" name="venue" />
            </div>
              
            <div class="form-group">
              <label for="location">Google Maps Location</label>
              <input type="text" id="location" placeholder="Share maps URL or address" [(ngModel)]="form.location" name="location" />
            </div>
              
            <div class="form-group">
              <label for="indoorOutdoor">Indoor or Outdoor?</label>
              <div class="radio-group">
                <label class="radio-option">
                  <input type="radio" name="indoorOutdoor" [(ngModel)]="form.indoorOutdoor" value="Indoor" />
                  <span>Indoor</span>
                </label>
                <label class="radio-option">
                  <input type="radio" name="indoorOutdoor" [(ngModel)]="form.indoorOutdoor" value="Outdoor" />
                  <span>Outdoor</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Step 3: Backdrop Selection -->
          <div *ngSwitchCase="2" class="form-step">
            <div class="form-group">
              <label for="backdropTheme">Backdrop Theme</label>
              <input type="text" id="backdropTheme" placeholder="Describe your desired theme" [(ngModel)]="form.backdropTheme" name="backdropTheme" />
            </div>
            
            <div class="color-selection">
              <div class="color-picker">
                <label for="primaryColor">Primary Color</label>
                <div class="color-input">
                  <input type="color" id="primaryColor" [(ngModel)]="form.primaryColor" name="primaryColor" />
                  <span class="color-value">{{form.primaryColor}}</span>
                </div>
              </div>
              
              <div class="color-picker">
                <label for="secondaryColor">Secondary Color</label>
                <div class="color-input">
                  <input type="color" id="secondaryColor" [(ngModel)]="form.secondaryColor" name="secondaryColor" />
                  <span class="color-value">{{form.secondaryColor}}</span>
                </div>
              </div>
              
              <div class="color-picker">
                <label for="tertiaryColor">Tertiary Color</label>
                <div class="color-input">
                  <input type="color" id="tertiaryColor" [(ngModel)]="form.tertiaryColor" name="tertiaryColor" />
                  <span class="color-value">{{form.tertiaryColor}}</span>
                </div>
              </div>
            </div>
            
            <div class="form-group">
              <label for="character">Character Preference</label>
              <input type="text" id="character" placeholder="Any specific character theme?" [(ngModel)]="form.character" name="character" />
            </div>
            
            <div class="checkbox-group">
              <label class="checkbox-option">
                <input type="checkbox" [(ngModel)]="form.table" name="table" />
                <span>Table Required</span>
              </label>
              
              <label class="checkbox-option">
                <input type="checkbox" [(ngModel)]="form.cakeStand" name="cakeStand" />
                <span>Cake Stand / Plinth</span>
              </label>
            </div>
            
            <div class="form-group">
              <label for="backdropCount">Number of Backdrops</label>
              <input type="number" id="backdropCount" placeholder="How many backdrops?" [(ngModel)]="form.backdropCount" name="backdropCount" min="1" />
            </div>
            
            <div class="form-group">
              <label for="customText">Custom Wording</label>
              <input type="text" id="customText" placeholder="Any text you want on the backdrop?" [(ngModel)]="form.customText" name="customText" />
            </div>
          </div>

          <!-- Step 4: Add-ons -->
          <div *ngSwitchCase="3" class="form-step">
            <div class="checkbox-group">
              <label class="checkbox-option">
                <input type="checkbox" [(ngModel)]="form.lighting" name="lighting" />
                <span>Additional Lighting</span>
              </label>
            </div>
            
            <div class="form-group">
              <label for="letters">Display Letters</label>
              <input type="text" id="letters" placeholder="Any letter displays needed?" [(ngModel)]="form.letters" name="letters" />
            </div>
            
            <div class="form-group">
              <label>Additional Options</label>
              <div class="addon-options">
                <label class="checkbox-option" *ngFor="let addon of availableAddons">
                  <input type="checkbox" 
                         [checked]="form.addons.includes(addon)"
                         (change)="toggleAddon(addon)"/>
                  <span>{{addon}}</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Step 5: Upload -->
          <div *ngSwitchCase="4" class="form-step">
            <div class="upload-area">
              <div class="upload-box" (click)="fileInput.click()" [class.has-file]="file">
                <input #fileInput type="file" (change)="onFileSelected($event)" hidden />
                <div *ngIf="!file" class="upload-placeholder">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <p>Click to upload reference images</p>
                  <span>or drag and drop your files here</span>
                </div>
                <div *ngIf="file" class="file-info">
                  <i class="fas fa-file-image"></i>
                  <p>{{file.name}}</p>
                  <span>{{(file.size / 1024).toFixed(1)}} KB</span>
                  <button type="button" class="remove-file" (click)="removeFile($event)">Remove</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 6: Budget & Payment -->
          <div *ngSwitchCase="5" class="form-step">
            <div class="form-group">
              <label for="budget">Estimated Budget Range</label>
              <input type="text" id="budget" placeholder="What's your budget for this event?" [(ngModel)]="form.budget" name="budget" />
            </div>
            
            <div class="form-group">
              <label>Preferred Payment Method</label>
              <div class="payment-options">
                <label class="radio-option">
                  <input type="radio" name="payment" [(ngModel)]="form.payment" value="Online" />
                  <span><i class="fas fa-credit-card"></i> Online Payment</span>
                </label>
                <label class="radio-option">
                  <input type="radio" name="payment" [(ngModel)]="form.payment" value="Cash" />
                  <span><i class="fas fa-money-bill-wave"></i> Cash on Event</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Step 7: Confirmation -->
          <div *ngSwitchCase="6" class="form-step">
            <div class="form-group">
              <textarea rows="4" placeholder="Any special requests or notes?" [(ngModel)]="form.notes" name="notes"></textarea>
            </div>
            
            <div class="terms-container">
              <label class="checkbox-option terms-checkbox">
                <input type="checkbox" [(ngModel)]="form.terms" name="terms" required />
                <span>I agree to the <a href="#">Terms and Conditions</a></span>
              </label>
            </div>
          </div>
        </ng-container>

        <div class="buttons">
          <button type="button" class="btn-back" (click)="prevStep()" [disabled]="currentStep === 0">
            <i class="fas fa-chevron-left"></i> Back
          </button>
          <button type="button" class="btn-next" *ngIf="currentStep < steps.length - 1" (click)="nextStep()">
            Next <i class="fas fa-chevron-right"></i>
          </button>
          <button type="submit" class="btn-submit" *ngIf="currentStep === steps.length - 1">
            Submit Booking <i class="fas fa-check"></i>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>